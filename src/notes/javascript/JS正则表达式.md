# JS 正则表达式

JS 正则表达式可以通过两种方式声明：

```js
let reg = /abc/gi;
let reg1 = new regExp('ab+c', 'm');
```

## 标志 flag

可用的 flag 包括：

1. g，全局搜索。
2. i，不区分大小写搜索。
3. m，多行搜索。
4. s，允许 . 匹配换行符。
5. u，使用 unicode 码的模式进行匹配。
6. y，执行“粘性”搜索,匹配从目标字符串的当前位置开始（正则实例的`re.lastIndex`），可以使用 y 标志。

## 正则表达式特殊字符

1. `\`，转义符号，将部分符号转义为特殊字符，在`[]`内只有`[`，`]`两个字符以及`-`需要转义。
2. `^`仅匹配字符串开头符合要求的串，若多行`'m'`为真则对换行符后的字符同样有效。
3. `$`匹配字符串尾，与`^`相对。
4. `{n}`，匹配次数修饰符，对该式前面的结果匹配`n`次。
5. `{n,}`，匹配至少`n`次。
6. `{n,m}`，匹配`n`至`m`次。
7. `*`，匹配至少`0`次，即可以没有。
8. `+`，匹配至少一次。
9. `?`，若跟在表达式后，表示匹配`0`次或`1`次，若跟在匹配次数修饰符后，表示`非贪婪匹配`，即满足条件下尽可能匹配更短的串。
10. `.`，匹配换行符外任意字符，若`'s'`为真则会匹配包括换行符的任意字符。
11. `(abc)`，捕获括号，该内容在`reg.exec`结果集中会展示出来，也就是会被捕获。
12. `(?:abc)`，非捕获括号，该内容在`reg.exec`结果中不会展示。
13. `x|y`，匹配 x 或者 y。
14. `[abc]`字符集合，可以用短横线来表示范围`[a-zA-Z0-9]`。
15. `[^abc]`反向字符集合，与字符集合用法相近。

### 特殊匹配

1. `[\b]`，匹配一个退格。
2. `\b`，匹配一个边界，一个词的边界就是一个词不被另外一个“字”字符跟随的位置或者前面跟其他“字”字符的位置，例如在字母和空格之间。注意，匹配中不包括匹配的字边界。换句话说，一个匹配的词的边界的内容的长度是 0。
3. `\B`，匹配一个非边界，例如，/\B../匹配"noonday"中的'oo', 而/y\B../匹配"possibly yesterday"中的'yes'。
4. `\cX`，若 X 为 A-Z 之间的字符，则匹配对应控制字符，例如，/\cM/ 匹配字符串中的 control-M (U+000D)。
5. `\d`，匹配一个数字。等价于[0-9]。
6. `\B`，匹配一个非数字字符。等价于[^0-9]。
7. `\r`，匹配一个回车符。(U+000D)。
8. `\n`，换行符。 (U+000A)。
9. `\f`，换页符。(U+000C)。
10. `\s`，匹配一个空白字符，包括空格、制表符、换页符和换行符。等价于`[\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]`。
11. `\S`，匹配一个非空白符。
12. `\t`，匹配一个水平制表符 (U+0009)。
13. `\v`，匹配一个垂直制表符 (U+000B)。
14. `\w`，匹配一个单字字符（字母、数字或者下划线）。等价于 [A-Za-z0-9_]。
15. `\W`，匹配一个非单字字符。等价于 [^a-za-z0-9_]。
16. `\n`，n 为整数，在正则表达式中，它返回最后的第 n 个子捕获匹配的子字符串(捕获的数目以左括号计数)。比如 `/apple(,)\sorange\1/` 匹配`"apple, orange, cherry, peach."`中的`'apple, orange,'`。
17. `\0`，匹配 NULL（U+0000）字符，不要在这后面跟其它小数，因为 `\0<digits>` 是一个八进制转义序列。
18. `\xhh`，与代码 hh 匹配字符（两个十六进制数字）。
19. `\uhhhh`，与代码 hhhh 匹配字符（四个十六进制数字）。
20. `\u{hhhh}`，（仅当设置了 u 标志时）使用 Unicode 值 hhhh 匹配字符（十六进制数字）。

### 断言

**断言本身性能较差，同时后行断言有兼容问题（如IE），可考虑使用分组提取需要的数据**

1. `x(?=y)`，先行断言，仅匹配后面有 y 的 x。
2. `x(?!y)`，先行否定断言，仅匹配后面没有 y 的 x。
3. `(?<=y)x`，后行断言，仅匹配前面有 y 的 x。
4. `(?<!y)x`，后行否定断言，仅匹配前面没有 y 的 x。

### 常用方法

1. `reg.exec(str)`，返回对字符串的第一个匹配结果以及其内部所有捕获组。**该函数会根据reg当前对属性（如lastIndex）进行执行**
2. `reg.test(str)`，判断字符串内部是否有匹配。
3. `str.match(reg)`，返回字符串内第一个匹配，若设置了`'g'`标志位则返回全部。
4. `str.matchAll(reg)`，ES6 新增，返回全部结果，返回值为迭代器。
5. `str.search(reg)`，返回第一个匹配的索引。
6. `str.replace(reg,substr)`，将 str 内部第一个 reg 的匹配替换为 substr，标志位`'g'`使其变为全局替换。substr 可以用`$`来代表内部捕获组的结果。
7. `str.split(reg)`，按照所有匹配对字符串进行切割，返回切割结果数组。

### RegExp

正则构造函数，上有一些全局属性。

1. RegExp.$1...$9，正则匹配时捕获符号匹配的字串会放在对应位置（字符串函数match等也会处理）。

